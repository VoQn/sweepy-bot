# DiscordBotBase

GlitchでDiscordBotを作るためのベースです。

## 詳細

[誰でも作れる！Discord Bot（基礎編）](https://note.com/exteoi/n/nf1c37cb26c41)をお読みください。

## ほんちゃん WANTS!

- 基盤
  - typescript化
  - Jestで、メッセージ処理はテストできるように
  - herokuで動くように
- 機能
  - welcome message機能。
    - dynoより可愛さをアピール
  - welcomeで自己紹介した人にのみ「認証済み」ロールを付ける
  - コマンド別にソース分けて追加を容易にしておく
  - コマンド機能
    - `!cheetsheet` チートシートを返すコマンド。 
      - `!cheetsheet` のみの場合は呼び出せる一覧。 
      - できれば `!cheetsheet 作物 温度` とかでフルパスなしで絞り込みできるように
    - `!液体 [温度]` 液体の比重を軽い順のリストを返す。その温度で液体の物質のみで返す。温度が指定されなかったら、25℃で。
    - `!気体` 気体の比重を(ry)
    - `!emojinate [アルファベット + ! + ?]` EMOJIにしてくれる。一部の記号も使える。
    - `!role` 可能なら自己申告で「配信者」とか「Modder」のロールを付与
    - `!critter [日本語名/英語名]` 生き物の細かい生存条件等
    - `!plant [https://gyazo.com/40046ca4b7ad9e395cc43a74ce85ae0d日本語名/英語名]` 作物の細かい生育条件等
    - `!refinery-temp [製錬対象] [冷却液]` 精錬する金属と冷却液の組み合わせで、一回で何度冷却液の温度が上がるか
    - `!aquatuner [物質名]` 14℃で何DTU変わるか (10kg * SHC * 14K)を返す。
    - `!regulator [気体名]` -１４Kで何DTU変わるか (1kg * SHC * 14K)を返す。
    - `!weezewhote [気体名]` -5Kで何DTU変わるか （1kg * SHC * 5K）を返す
    - `!turbine [温度]@[intake]` タービンの諸元を返す
      - 水蒸気から除去した熱量: (入力水蒸気温度-95)[K] * 水SHC * 0.4kg * intake 
      - 発熱量: 4kDTU + 水蒸気から除去した熱量 * 0.1
      - 熱消去量: 水蒸気から除去した熱量 - 発熱量
      - 最大発電量時の熱消去量: {(200-95) * 水SHC * 2kg} = 877.59kDTU
      - 発電量: 水蒸気から除去した熱量 / 最大発電量時の熱消去量 * 850W
    - `!turbine [温度]` 最適なintake数を返す？ (1個～5個)
      - 発電量が850W上限になる、最大のintake数
      - 発電量が850W以下の、最小のintake数 (↑と1個差になるはずなので、こっちだけ返すのでも良いかも)

  - (自分の)おはようからおやすみまで暮らしを見つめる機能
    - herokuのダウンタイムに合わせて、おはようとおやすみのメッセージを投稿する
    - かわいい
  - ボイスchで配信がはじまったら、#配信告知で何か言う
  - ゲームのupdate情報 RSSを自動投稿
    - https://store.steampowered.com/feeds/newshub/app/457140/?cc=JP&l=japanese&snr=1_2108_9__1601
  - embedメッセージに対応して、見た目を超リッチに。
    - [Discord.jsでembed (埋め込みメッセージ) を扱う - Qiita](https://qiita.com/nedew/items/4e0c20c1a89e983a6992)
  - 英語日本語翻訳辞書を持っときたい
    - 各 commands で利用できる形の辞書がほしい
    - debug name も出してほしい
      - サンドボックスモードだと名前が違う
        

# 注意

watch.jsonで変更検知を制御してます。
いまのところ1分おきに反映です。login APIのrate limitsは1日1000回っぽいので、再起動は1000回までに止めたい。1.44分おきに1回まで許されるので、1分おきにしました。
再起動対象のファイルは拡張子で制御してますが、includeのパターンを追加すれば他のファイルも扱えます。
